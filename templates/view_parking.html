{% extends "base.html" %}

{% block content %}
<h1 class="mb-4" style="color: rgb(255, 255, 255);">Available Parking Slots</h1>

{% if lots_data %}
    {% for lot_data in lots_data %}
    <div class="card mb-4 shadow">
        <div class="card-header bg-dark text-white">
            <h3 class="mb-1">{{ lot_data.lot.name }} <small class="text-muted">({{ lot_data.lot.location }})</small></h3>
            <p class="mb-1">
                {% if lot_data.lot.price is not none %}
                    Price: â‚¹{{ "{:,.2f}".format(lot_data.lot.price) }}/hour
                {% else %}
                    Price: N/A
                {% endif %}
            </p>
            <p class="mb-1">
                {% if lot_data.lot.address %}
                    Address: {{ lot_data.lot.address }}
                {% else %}
                    Address: N/A
                {% endif %}
            </p>
            <p class="mb-0">
                {% if lot_data.lot.pin_code %}
                    PIN Code: {{ lot_data.lot.pin_code }}
                {% else %}
                    PIN Code: N/A
                {% endif %}
            </p>
        </div>
        <div class="card-body">
            <div class="row row-cols-2 row-cols-md-4 row-cols-lg-6 g-3">
                {% for slot in lot_data.slots %}
                <div class="col">
                    <div class="card h-100 text-center
                        {% if slot.status == 'available' %}
                            border-success text-success bg-light
                        {% elif slot.status == 'occupied' %}
                            border-warning text-warning bg-light
                        {% elif slot.status == 'maintenance' %}
                            border-info text-info bg-light
                        {% else %}
                            border-danger text-danger bg-light
                        {% endif %}
                    ">
                        <div class="card-body d-flex flex-column justify-content-between align-items-center">
                            <h5 class="card-title mb-2">Slot {{ slot.number }}</h5>
                            <p class="card-text fw-bold">
                                {% if slot.status == 'available' %}
                                    Available
                                {% elif slot.status == 'occupied' %}
                                    Occupied
                                {% elif slot.status == 'maintenance' %}
                                    Under Maintenance
                                {% else %}
                                    Unavailable
                                {% endif %}
                            </p>
                            {% if slot.status == 'available' %}
                                <a href="{{ url_for('main.book_slot', slot_id=slot.id) }}" class="btn btn-sm btn-success mt-2">Book Now</a>
                            {% else %}
                                <button class="btn btn-sm btn-secondary mt-2" disabled>
                                    {% if slot.status == 'occupied' %}
                                        Occupied
                                    {% elif slot.status == 'maintenance' %}
                                        Maintenance
                                    {% else %}
                                        Booked
                                    {% endif %}
                                </button>
                            {% endif %}

                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>
    {% endfor %}
{% else %}
    <div class="alert alert-warning" role="alert">
        No parking lots or slots available at the moment.
    </div>
{% endif %}
{% endblock %}